# 手势控制粒子效果项目

## 项目概述

这是一个基于Web的实时手势识别与粒子动画交互系统。通过摄像头捕捉用户的手势动作，系统能够识别手指数量，并将手势信息转化为炫酷的粒子动画效果。

## 功能特性

- **实时手势识别**: 利用ml5.js的handpose模型检测用户手势
- **动态粒子系统**: 粒子根据手势形成不同形状（握拳、数字1-4、散开状态）
- **手动控制模式**: 在没有摄像头时可使用按钮手动控制
- **自适应界面**: 支持窗口大小调整，粒子系统自动适应屏幕尺寸
- **视觉反馈**: 实时显示手势状态和调试信息

## 技术栈

- HTML5 Canvas
- JavaScript (ES6+)
- [p5.js](https://p5js.org/) - 用于图形绘制和动画
- [ml5.js](https://ml5js.org/) - 用于手势识别
- Handpose 模型 - 手势关键点检测

## 安装与运行

### 本地运行

1. 确保你有一个支持HTML文件服务的Web服务器，并打开HTTPS协议的地址，例如：
   - Node.js: `npx serve` 或者 `npx anywhere`
   - Python: `python -m http.server 8000`
   - Live Server (VS Code插件)

2. 直接打开 [index.html](file://d:\workspace\hand-pose-demo\index.html) 文件无法正常工作，因为摄像头访问需要HTTPS或localhost环境

### 注意事项

- 需要摄像头权限
- 最佳体验需要现代浏览器支持WebGL和MediaDevices API
- 推荐在良好光照条件下使用

## 使用说明

### 自动手势识别模式

1. 允许网站访问摄像头
2. 将手放置在摄像头前
3. 系统会自动识别手势并显示相应的粒子效果

### 手动控制模式

在没有摄像头的情况下，可以使用下方按钮手动控制：

- **握拳**: 显示小球形状
- **1根手指**: 显示数字1
- **2根手指**: 显示数字2
- **3根手指**: 显示数字3
- **4根手指**: 显示数字4
- **5根手指**: 显示散开状态

### 控制按钮

- **开启/关闭自动检测**: 切换自动手势识别与手动控制模式

## 代码结构

- [index.html](file://d:\workspace\hand-pose-demo\index.html): 主页面，包含所有功能实现
- 样式定义: 页面布局和视觉效果
- JavaScript:
  - 全局变量管理
  - 手势识别逻辑 (`countFingers`)
  - 粒子系统 (`ParticleSystem`类)
  - UI交互控制

## 核心功能实现

### 手势识别算法

`countFingers` 函数通过分析手部关键点之间的距离和角度来判断手指展开状态：

- 对四根长手指：通过指尖相对于掌指关节(MCP)的位置判断
- 对拇指：结合角度和距离双重条件判断

### 粒子系统

`ParticleSystem` 类实现了复杂的粒子动画效果：

- **弹簧物理系统**: 粒子围绕目标位置振荡
- **形状变换**: 根据手势形成不同形状（握拳、数字等）
- **3D效果**: 通过深度映射实现立体感
- **动态振荡**: 粒子在目标形状周围持续小幅振荡

### 窗口自适应

实现了节流的窗口大小调整处理，确保在改变窗口大小时粒子形状能正确更新。

## 性能优化

- 粒子数量控制（默认1000个）
- 窗口调整节流机制
- 图像处理优化（间隔采样）

## 浏览器兼容性

- Chrome/Firefox/Safari (最新版本)
- Edge (Chromium-based)
- 需要支持WebGL和MediaDevices API

## 故障排除

- **摄像头无法访问**: 检查浏览器权限设置
- **手势识别不准确**: 确保光线充足，手部清晰可见
- **性能问题**: 降低粒子数量或关闭不必要的浏览器扩展

## 许可证

本项目为演示用途，使用MIT许可证。引用的第三方库遵循各自许可证。